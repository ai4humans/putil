#!/usr/bin/env python
# get-site-packages-dir.py
# Copyright (c) 2013-2015 Pablo Acosta-Serafini
# See LICENSE for details
# pylint: disable=C0111,C0103

import distutils.sysconfig, os, sys, subprocess


def main_alt(version):
	"""
	Find location of python${version}/site-packages/ directory with
	shell command find
	"""
	pobj = subprocess.Popen(
		['find', os.sep, '-name', 'pcontracts.py'],
		stdout=subprocess.PIPE,
		stderr=subprocess.PIPE
	)
	out, _ = pobj.communicate()
	dirs = []
	for line in out.split('\n'):
		if os.path.join(
				'python{0}'.format(version),
				'site-packages',
				'putil') in line:
			dirs.append(line)
	if not dirs:
		raise RuntimeError('Python site-packages directory could not be found')
	if len(dirs) > 2:
		raise RuntimeError('More than two possible Python site-packages directories')
	site_pkg_dir = dirs[0]
	print site_pkg_dir


def main(version):
	"""
	Find location of python${version}/site-packages/ directory with
	Python module
	"""
	site_pkg_dir = distutils.sysconfig.get_python_lib()
	if 'python{0}'.format(version) not in site_pkg_dir:
		raise RuntimeError(
			'Python site-packages directory could not be found, got {0}'.format(
				site_pkg_dir
			))
	print site_pkg_dir


if __name__ == '__main__':
	main(sys.argv[1])

